# 2023-04-14 Implementation Plan: Evaluating Rekognition Data

<!-- See the implementation plan guide for more information: https://docs.openverse.org/projects/planning.html#implementation-plans-status-in-rfc -->
<!-- This template is exhaustive and may include sections which aren't relevant to your project. Feel free to remove any sections which would not be useful to have. -->

## Reviewers

<!-- Choose two people at your discretion who make sense to review this based on their existing expertise. Check in to make sure folks aren't currently reviewing more than one other proposal or RFC. -->

- [ ] @obulat
- [ ] @krysal

## Project links

<!-- Enumerate any references to other documents/pages, including milestones and other plans -->

- [Project Thread](https://github.com/WordPress/openverse/issues/431)

## Overview

<!-- An overview of the implementation plan, if necessary. Save any specific steps for the section(s) below. -->

This implementation plan aims to analyze rekognition object labels for around
100 million images and select relevant labels to be added as tags to the catalog
database. The project background involves the need to evaluate the collected
labels for compliance with content standards.

To achieve this, the following steps will be taken:

    Collect a list of all unique labels from the rekognition object labels for the 100 million images.
    Evaluate the labels based on the content standards to ensure they meet the criteria for inclusion as tags in the catalog database.
    Manually test a random sample of labels and accuracies to determine the ideal accuracy level for the project. This will involve a naive approach, but it will be a simple and effective way to identify the accuracy level that best suits the project needs.

By following this implementation plan, we will be able to efficiently evaluate
the collected rekognition object labels and select relevant labels to be added
as tags to the catalog database, which will facilitate better search and
organization of the image catalog.

## Expected Outcomes

<!-- List any succinct expected products from this implementation plan. -->

- A list of all unique labels from the rekognition object labels for the 100
  million images.
- A human-selected set of labels to _reject_ for inclusion in the catalog
- A defined minimum accuracy level for included labels
- A count of exactly how many images are in the dataset, to know how big the
  overall impact on the catalog will be

## Outlined Steps

<!-- Describe the implementation step necessary for completion. -->

- Develop a python script that will perform the required analysis on the
  rekognition object labels and generate deliverable files. The script will also
  write all unique labels and their counts to a CSV file.
- Stream the rekognition data from S3 to the python script and run it on an EC2
  instance to take advantage of better bandwidth to S3.
- Develop a script that will randomly select 200 images from the 100 million
  images and write them to a file for manual evaluation.
- A human evaluator will manually review the 200 images to evaluate the accuracy
  of their tags.
- Using the list of all tags generated by the python script, the human evaluator
  will determine which tags should be excluded based on content standards.
- The finalized list of relevant tags will be added to the catalog database as
  tags.

## Dependencies

### Infrastructure

<!-- Describe any infrastructure that will need to be provisioned or modified. In particular, identify associated potential cost changes. -->

- Manually provision an `m5n.2xlarge` EC2 instance running Amazon Linux 2. The
  instance will be run for approximately 2-3 hours and swiftly terminated after
  deliverables are downloaded locally. This should cost $0.476/hr and be an
  effective, high-bandwidth choice.
  - This approach was tested with a `m4.large` instance with a 60% lower network
    speed than the aforementioned instance type. The `extract_unique_labels.py`
    example script took two hours to run and generated a 38kb file.
  - For simple SSH access, a new key should be provisioned exclusively for the
    instance and the instance should be added to a security group which gives
    the local IP of the developer executing the code SSH access. This should be
    a sufficient balance between simplicity and security for a one-off script
    like this.
  - Deliverables written and stored to the local disk of the instance should be
    downloaded via scp on the machine of the implementing developer. For
    example:
    `scp -i "test-rekognition-key-example.pem" ec2-user@{ip}:label_count.csv ~/Downloads/label_count.csv`.

### Tools & packages

<!-- Describe any tools or packages which this work might be dependent on. If multiple options are available, try to list as many as are reasonable with your own recommendation. -->

### Other projects or work

<!-- Note any projects this plan is dependent on. -->

## Alternatives

<!-- Describe any alternatives considered and why they were not chosen or recommended. -->

## Design

<!-- Note any design requirements for this plan. -->

## Parallelizable streams

<!-- What, if any, work within this plan can be parallelized? -->

## Blockers

<!-- What hard blockers exist which might prevent further work on this project? -->

## API version changes

<!-- Explore or mention any changes to the API versioning scheme. -->

## Accessibility

<!-- Are there specific accessibility concerns relevant to this plan? Do you expect new UI elements that would need particular care to ensure they're implemented in an accessible way? Consider also low-spec device and slow internet accessibility, if relevant. -->

## Rollback

<!-- How do we roll back this solution in the event of failure? Are there any steps that can not easily be rolled back? -->

## Privacy

<!-- How does this approach protect users' privacy? -->

## Localization

<!-- Any translation or regional requirements? Any differing legal requirements based on user location? -->

## Risks

<!-- What risks are we taking with this solution? Are there risks that once taken canâ€™t be undone?-->

## Prior art

<!-- Include links to documents and resources that you used when coming up with your solution. Credit people who have contributed to the solution that you wish to acknowledge. -->
